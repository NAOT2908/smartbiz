<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

  <!-- Selector -->
  <t t-name="smartbiz_barcode_stock.Selector">
    <div class="s_selector-modal">
      <div class="s_selector-modal-content">

        <!-- HEADER -->
        <div class="s_selector-header">
          <h2><t t-esc="props.function"/></h2>
          <i class="fa fa-barcode" t-on-click="openManualScanner"/>
        </div>

        <!-- CONTENT -->
        <div class="s_selector-content">

          <!-- ===== CHẾ ĐỘ CHỌN BẢN GHI ===== -->
          <t t-if="props.isSelector">

            <!-- Search box -->
            <input  t-model="state.searchQuery"
                    placeholder ="Search…"
                    class="s_selector-search-input"/>

            <!-- Qty box (chỉ khi chọn sản phẩm) -->
            <input  t-if="props.title === 'Select Product'"
                    t-model="state.quantity"
                    placeholder="Enter product quantity"
                    class="s_selector-search-input"/>

            <!-- Record list -->
            <ul class="s_selector-record-list">
              <t t-foreach="filteredRecords" t-as="record" t-key="record.id">
                <li t-on-click="() => this.selectRecord(record.id)"
                    t-att-class="{'s_selector-selected': state.selectedRecords.includes(record.id)}">
                  <span class="record-name">
                    <t t-esc="record.display_name || record.name"/>
                  </span>
                  <span class="record-name"><t t-esc="record.origin || ''"/></span>

                  <span t-if="state.selectedRecords.includes(record.id) || state.selectedRecord === record.id">
                    <i class="fa fa-pencil" t-on-click="() => this.editRecord(record.id)"/>
                  </span>
                  <span t-if="state.selectedRecords.includes(record.id) || state.selectedRecord === record.id"
                        class="record-checkmark">
                    &#10003;
                  </span>
                </li>
              </t>
            </ul>
          </t>

          <!-- ===== SPLIT PACKAGES ===== -->
          <t t-if="!props.isSelector &amp;&amp; props.title === 'Split Packages'">
            <div class="package-info">

              <div class="package-info-item">
                <label for="packageName">Source Package:</label>
                <div id="packageName" class="s_selector-info-output" t-esc="state.packageName"/>
              </div>

              <div class="package-info-item">
                <label for="packageProductQty">Current quantity:</label>
                <div id="packageProductQty" class="s_selector-info-output" t-esc="state.packageProductQty"/>
              </div>

              <div class="package-info-item">
                <label for="qtyPerPackage">Qty per package:</label>
                <input id="qtyPerPackage" t-model="state.qtyPerPackage" class="s_selector-search-input"/>
              </div>

              <!-- Switch -->
              <div class="package-info-item">
                <label for="showPackageQty">Create new package?</label>
                <label class="switch">
                  <input type="checkbox" id="showPackageQty" t-model="state.showPackageQty"/>
                  <span class="slider round"/>
                </label>
              </div>

              <!-- New-package qty -->
              <div t-if="state.showPackageQty">
                <div class="package-info-item">
                  <label for="packageQty">New package qty:</label>
                  <input id="packageQty" t-model="state.packageQty" class="s_selector-search-input"/>
                </div>
              </div>

              <!-- Destination packages -->
              <div t-if="!state.showPackageQty">
                <div class="package-info-item">
                  <label >Destination packages:</label>
                  <div class="package-tags">
                    <t t-foreach="state.processedPackages" t-as="package" t-key="package.id">
                      <span class="package-tag">
                        <t t-esc="package.name"/>
                        <i class="fa fa-times remove-icon"
                           title="Remove"
                           t-on-click="() => this.removeProcessedPackage(package.id)"/>
                      </span>
                    </t>
                  </div>
                </div>
              </div>

            </div>
          </t>

          <!-- ===== BULK PACK ===== -->
          <t t-if="!props.isSelector &amp;&amp; props.title === 'Bulk Pack'">
            <div class="package-info">

              <div class="package-info-item">
                <label for="productName">Product name:</label>
                <div id="productName" class="s_selector-info-output" t-esc="props.move.product_name"/>
              </div>

              <t t-if="props.move.product_tracking !== 'none'">
                <div class="package-info-item">
                  <label for="lotName" >Lot number:</label>
                  <input id="lotName" t-model="state.lot_name" class="s_selector-search-input"/>
                </div>
              </t>

              <div class="package-info-item">
                <label for="remainingQty">Remaining demand:</label>
                <div id="remainingQty" class="s_selector-info-output"
                     t-esc="this.roundToTwo(props.move.product_uom_qty - props.move.quantity)"/>
              </div>

              <div class="package-info-item">
                <label for="qtyPerPackage">Qty per pack:</label>
                <input id="qtyPerPackage" t-model="state.qtyPerPackage" class="s_selector-search-input"/>
              </div>

              <div class="package-info-item">
                <label for="packageQty">Number of packs:</label>
                <input id="packageQty" t-model="state.packageQty" class="s_selector-search-input"/>
              </div>

            </div>
          </t>

          <!-- ===== RECEIVE BY SERIAL ===== -->
          <t t-if="!props.isSelector &amp;&amp; props.title === 'Receive by Serial'">
            <div class="package-info">

              <div class="package-info-item">
                <label for="productName">Product name:</label>
                <div id="productName" class="s_selector-info-output" t-esc="props.move.product_name"/>
              </div>

              <div class="package-info-item">
                <label>
                 Serial list:(<t t-esc="state.processedSerials.length"/>)
                </label>
                <div class="package-tags">
                  <t t-foreach="state.processedSerials" t-as="serial" t-key="serial">
                    <span class="package-tag">
                      <t t-esc="serial"/>
                      <i class="fa fa-times remove-icon"
                         title="Remove"
                         t-on-click="() => this.removeProcessedSerial(serial)"/>
                    </span>
                  </t>
                </div>
              </div>

              <div class="package-info-item">
                <label for="qtyPerPackage">Qty per pack:</label>
                <input id="qtyPerPackage" t-model="state.qtyPerPackage" class="s_selector-search-input"/>
              </div>

              <!-- Switch -->
              <div class="package-info-item">
                <label for="showPackageQty">Create new package?</label>
                <label class="switch">
                  <input type="checkbox" id="showPackageQty" t-model="state.showPackageQty"/>
                  <span class="slider round"/>
                </label>
              </div>

              <!-- Destination packages -->
              <div t-if="!state.showPackageQty">
                <div class="package-info-item">
                  <label>Destination packages:</label>
                  <div class="package-tags">
                    <t t-foreach="state.processedPackages" t-as="package" t-key="package.id">
                      <span class="package-tag">
                        <t t-esc="package.name"/>
                        <i class="fa fa-times remove-icon"
                           title="Remove"
                           t-on-click="() => this.removeProcessedPackage(package.id)"/>
                      </span>
                    </t>
                  </div>
                </div>
              </div>

            </div>
          </t>

        </div> <!-- /s_selector-content -->

        <!-- ACTION BUTTONS -->
        <div class="s_selector-action-buttons">
          <button t-if="state.showCreateNew &amp;&amp; state.selectedRecord === 0"
                  t-on-click="createNew" >Create</button>

          <button t-if="state.selectedRecord != 0 || state.selectedRecords"
                  t-on-click="confirmSelection">Confirm</button>

          <button t-on-click="cancelSelection">Cancel</button>
        </div>

      </div> <!-- /modal-content -->
    </div>   <!-- /modal -->
  </t>

</templates>
